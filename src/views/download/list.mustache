{{< index }}
{{$ content}}
<script>

    function clearDoneDownloads(){
        $.ajax({
            type: "POST",
            url: "api.php?service=download&action=clear_done",
            data: "",
            success : function(toto){
                var dip = '';
                for (var i = 0; i < toto.length; i++) {
                    dip += toto[i] + '<br />';
                }
                console.log('Status : ', toto);
                location.href = '?service=download#done';
            }
        });
    }

    function clearDownload( id){
        $.ajax({
            type: "POST",
            url: "api.php?service=download&action=clear_id&id="+id,
            data: '',
            success : function(toto){
                console.log('Download cleared '+ id);
                console.log('Status : ', toto);
            }
        });
    }

</script>

<h1>Téléchargements</h1>
<p class="lead">Liste des téléchargements !</p>

<ul class="nav nav-tabs">
    <li class="active">
        <a href="#home" data-toggle="tab">Tous</a>
    </li>
    <li>
        <a href="#seed" data-toggle="tab">En partage</a>
    </li>
    <li>
        <a href="#download" data-toggle="tab">En cours</a>
    </li>
    <li>
        <a href="#done" data-toggle="tab">Terminés</a>
    </li>
</ul>

<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="home">
        <p>Tous les téléchargements</p>
        {{# getAll}}
            {{> download/task }}
        {{/ getAll}}
    </div>
    <div class="tab-pane fade" id="seed">
        <p>Téléchargements terminés en cours de partage</p>
        {{# getSeeding}}
            {{> download/task }}
        {{/ getSeeding}}
    </div>
    <div class="tab-pane fade" id="download">
        <p>Téléchargements en cours</p>
        {{# getInProgress}}
            {{> download/task }}
        {{/ getInProgress}}
    </div>
    <div class="tab-pane fade" id="done">
        <p>Téléchargements Terminés</p>
        <a href="#" onclick="clearDoneDownloads()" class="btn btn-default">Retirer les téléchargements terminées</a>
        {{# getDone}}
            {{> download/task }}
        {{/ getDone}}
    </div>
</div>

{{/ content}}
{{/ index }}
